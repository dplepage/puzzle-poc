(this["webpackJsonpreact-puzzles"]=this["webpackJsonpreact-puzzles"]||[]).push([[14],{15:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h}));var a=n(9),r=n(11),u=n(23),s=n(22),l=n(0),o=n.n(l),c=n(7);var i=function(e){var t=e.dir,n=e.children,a={display:"flex",flexDirection:t,alignItems:"stretch"};return e.lined&&(a.border="1px solid black"),o.a.createElement("div",{style:a},n)};function h(e){var t=e.data,n=e.label;return o.a.createElement("div",null,o.a.createElement("h1",null,n),o.a.createElement("ul",null,t.children.map((function(e){return o.a.createElement("li",{key:e.slug},o.a.createElement(c.b,{to:e.slug},o.a.createElement("label",null,e.label,e.solved?" - "+e.answer:"")))}))))}o.a.Component},39:function(e,t,n){e.exports=n(52)},44:function(e,t,n){},51:function(e,t,n){var a={"./puzz1_1":[29,9,0],"./puzz1_1.tsx":[29,9,0],"./puzz1_2":[30,9,1],"./puzz1_2.grid.png":[53,7,9],"./puzz1_2.tsx":[30,9,1],"./puzz2_1":[31,9,2],"./puzz2_1.tsx":[31,9,2],"./puzz2_2":[32,9,3],"./puzz2_2.tsx":[32,9,3],"./puzz3_1":[33,9,4],"./puzz3_1.tsx":[33,9,4],"./puzz3_2":[34,9,5],"./puzz3_2.tsx":[34,9,5],"./round1":[35,9,6],"./round1.man.png":[54,7,10],"./round1.tsx":[35,9,6],"./round2":[36,9,7],"./round2.plan.gif":[55,7,11],"./round2.tsx":[36,9,7],"./round3":[37,9,8],"./round3.canal.jpg":[56,7,12],"./round3.tsx":[37,9,8],"./start":[38,9,13],"./start.tsx":[38,9,13]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[2]).then((function(){return n.t(r,t[1])}))}r.keys=function(){return Object.keys(a)},r.id=51,e.exports=r},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(24),s=n.n(u),l=(n(44),n(2)),o=n.n(l),c=n(8),i=n(3),h=n(10),p=n(7),d=n(15),b=n(28),f=n(27),v=n(11),z=n(9),m=function(){function e(t){Object(z.a)(this,e),this.can_submit=void 0,this.answers=void 0,this.can_submit=t,this.answers=[]}return Object(v.a)(e,[{key:"has_answers",value:function(){return this.answers.length>0}},{key:"answer_str",value:function(){return this.answers.join(", ").toUpperCase()}}]),e}(),k=function e(t){var n=t.label,a=t.unlocks,r=void 0===a?[]:a,u=t.answer,s=t.load_puzzles;Object(z.a)(this,e),this.label=void 0,this.unlocks=void 0,this.answer=void 0,this.load_puzzles=void 0,this.label=n,this.unlocks=r,this.answer=u,this.load_puzzles=s||{}},g={start:new k({label:"The Start",load_puzzles:{round1:{image:"./round1.man.png",img_alt:"A Man"},round2:{image:"./round2.plan.gif",img_alt:"A Plan"},round3:{image:"./round3.canal.jpg",img_alt:"A Canal"}}}),round1:new k({label:"The First Round",load_puzzles:{puzz1_1:{},puzz1_2:{}}}),puzz1_1:new k({label:"Puzzle One",unlocks:["puzz1_2"]}),puzz1_2:new k({label:"An Image Puzzle",unlocks:["puzz2_1","round2"],answer:"VERMILLION"}),round2:new k({label:"The Second Round",load_puzzles:{puzz2_1:{},puzz2_2:{}}}),puzz2_1:new k({label:"A Tic-Tac-Toe 'Puzzle'",unlocks:["puzz2_2"],answer:"TICTACS"}),puzz2_2:new k({label:"Another Puzzle Two",unlocks:["puzz3_1","round3"]}),round3:new k({label:"The Final Round",load_puzzles:{puzz3_1:{},puzz3_2:{}}}),puzz3_1:new k({label:"The Final Puzzle One",unlocks:["puzz3_2"]}),puzz3_2:new k({label:"The Final Puzzle Two"})};function _(e,t){var n=g[e].answer;return void 0===n||n.toUpperCase()===t.toUpperCase()}var w=function(){function e(){Object(z.a)(this,e),this.state=void 0,this.state={}}return Object(v.a)(e,[{key:"get_state",value:function(e){return this.state.hasOwnProperty(e)||(this.state[e]={unlocked:!1,solved:!1,answers:[]}),this.state[e]}},{key:"get_vstate",value:function(e){var t,n=this.get_state(e),a=new m(!n.solved);return n.solved&&(t=a.answers).push.apply(t,Object(f.a)(n.answers)),a}}]),e}();function E(e,t){var n=[];Object.entries(g[e].load_puzzles).forEach((function(e){var a=Object(i.a)(e,2),r=a[0],u=a[1];t.get_state(r).unlocked&&n.push(Object(b.a)({label:g[r].label,slug:r,state:t.get_vstate(r)},u))}));var a=t.get_vstate(e);return e.startsWith("round")||(a.can_submit=!1),{label:g[e].label,state:a,children:n}}var y=function(){function e(t){Object(z.a)(this,e),this.hunt_state=void 0,this._version=void 0,this.callback=void 0,this.callback=t,this.hunt_state=new w,this._version=0,this.unlock_restart(!0)}return Object(v.a)(e,[{key:"version",value:function(){return this._version}},{key:"unlocked",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("nav"!==t){e.next=2;break}return e.abrupt("return",!0);case 2:return e.abrupt("return",this.hunt_state.get_state(t).unlocked);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unlock",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.hunt_state.get_state(t).unlocked=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get_nav",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,a,r,u,s,l,c,i,h,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=0,a=[1,2,3];case 2:if(!(n<a.length)){e.next=27;break}return r=a[n],u="round".concat(r),e.next=7,this.unlocked(u);case 7:if(e.sent){e.next=9;break}return e.abrupt("continue",24);case 9:s=[],l=0,c=[1,2];case 11:if(!(l<c.length)){e.next=22;break}return i=c[l],h="puzz".concat(r,"_").concat(i),e.next=16,this.unlocked(h);case 16:if(e.sent){e.next=18;break}return e.abrupt("continue",19);case 18:s.push({label:g[h].label,slug:h,state:this.hunt_state.get_vstate(h),children:[]});case 19:l++,e.next=11;break;case 22:p={label:g[u].label,slug:u,state:this.hunt_state.get_vstate(u),children:s},t.push(p);case 24:n++,e.next=2;break;case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get_data",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("nav"!==t){e.next=5;break}return e.next=3,this.get_nav();case 3:return n=e.sent,e.abrupt("return",{label:"N/A",state:new m(!1),nav_entries:n});case 5:if(!t.startsWith("puzz")){e.next=8;break}return a=this.hunt_state.get_vstate(t),e.abrupt("return",{label:g[t].label,state:a});case 8:return e.abrupt("return",E(t,this.hunt_state));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var a,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(t,n)){e.next=2;break}return e.abrupt("return",!1);case 2:return(a=this.hunt_state.get_state(t)).solved=!0,a.answers=[n],g[t].unlocks.forEach((function(e){return r.unlock(e)})),this.callback(++this._version),e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unlock_all",value:function(){for(var e=0,t=Object.keys(g);e<t.length;e++){var n=t[e];this.unlock(n)}this.callback(++this._version)}},{key:"unlock_restart",value:function(e){for(var t=this,n=0,a=Object.keys(g);n<a.length;n++){var r=a[n];this.hunt_state.get_state(r).unlocked=!1}this.unlock("start"),this.unlock("round1"),this.unlock("puzz1_1");for(var u=0,s=Object.keys(g);u<s.length;u++){var l=s[u];this.hunt_state.get_state(l).answers.length&&(this.unlock(l),g[l].unlocks.forEach((function(e){return t.unlock(e)})))}this._version=0,e||this.callback(this._version)}}]),e}();function O(e,t,n){var r=Object(a.useState)(null),u=Object(i.a)(r,2),s=u[0],l=u[1],h=Object(a.useState)("loading"),p=Object(i.a)(h,2),d=p[0],b=p[1];return Object(a.useEffect)((function(){function a(){return(a=Object(c.a)(o.a.mark((function a(){var r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return b("loading"),a.next=3,e.unlocked(t);case 3:if(a.sent){a.next=7;break}return b("404"),a.abrupt("return");case 7:return a.next=9,e.get_data(t);case 9:r=a.sent,window.console.log("Loaded data for ".concat(t," at version ").concat(n)),l(r),b("loaded");case 13:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[e,t,n]),[s,d]}var j=function(e){var t=e.slug,n=e.engine,u=e.vdata,s=u.state,l=Object(a.useState)(""),o=Object(i.a)(l,2),c=o[0],h=o[1],p=Object(a.useState)(""),d=Object(i.a)(p,2),b=d[0],f=d[1],v=[r.a.createElement("h1",{key:"label"},u.label)];if(s.has_answers()&&v.push(r.a.createElement("b",{key:"answer"},"Answer: ",s.answer_str())),s.can_submit){v.push(r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n.submit(t,c).then((function(e){f(e?"":c)})),h("")},key:"submit"},r.a.createElement("input",{type:"text",placeholder:"Enter anything",value:c,onChange:function(e){return h(e.target.value)}}),r.a.createElement("input",{type:"submit",value:"Submit"}))),""!==b&&v.push(r.a.createElement("b",{key:"wrong"},b.toUpperCase()," is INCORRECT"))}return r.a.createElement("div",null,v)},x=function(e){var t=e.engine,u=e.version,s=Object(h.f)().slug,l=O(t,s,u),p=Object(i.a)(l,2),d=p[0],b=p[1],f=function(e,t){var r=Object(a.useState)(null),u=Object(i.a)(r,2),s=u[0],l=u[1],h=Object(a.useState)("loading"),p=Object(i.a)(h,2),d=p[0],b=p[1];return Object(a.useEffect)((function(){function a(){return(a=Object(c.a)(o.a.mark((function a(){var r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return b("loading"),a.next=3,e.unlocked(t);case 3:if(a.sent){a.next=7;break}return b("404"),a.abrupt("return");case 7:return a.next=9,n(51)("./".concat(t));case 9:r=a.sent,window.console.log("Loaded view for ".concat(t)),l(r),b("loaded");case 13:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[e,t]),[s,d]}(t,s),v=Object(i.a)(f,2),z=v[0],m=v[1],k=r.a.createElement("div",null,"Loading...");return"404"===b||"404"===m?r.a.createElement("b",null,"404 - there's nothing here (or you haven't unlocked it yet!)"):null===d||"loading"===m?k:r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{slug:s,engine:t,vdata:d}),r.a.createElement(z.default,{data:d,engine:t}))};var T=function(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),n=t[0],u=t[1],s=Object(a.useState)(new y(u)),l=Object(i.a)(s,1)[0],o=O(l,"nav",n),c=Object(i.a)(o,1)[0];if(null===c)return r.a.createElement("div",null,"Loading...");var b=c.nav_entries,f=function(e){var t=e.puzzle,n=e.indent,a=t.label;return t.state.has_answers()&&(a+=" - "+t.state.answer_str()),n&&(a="> "+a),r.a.createElement(p.b,{to:"/hunt/".concat(t.slug)},a)};return r.a.createElement(p.a,null,r.a.createElement(d.a,{dir:"row"},r.a.createElement(p.b,{to:"/"},"Home"),"\xa0",r.a.createElement(p.b,{to:"/about"},"About"),"\xa0",r.a.createElement(p.b,{to:"/hunt/start"},"Hunt")),r.a.createElement(d.a,{dir:"row"},r.a.createElement("div",{style:{width:"200px",padding:"10px",margin:"10px",background:"lightgrey"}},r.a.createElement("h3",null,"Hack Navigation"),r.a.createElement("button",{onClick:function(){return l.unlock_all()}},"Unlock all"),r.a.createElement("button",{onClick:function(){return l.unlock_restart()}},"Relock unsolved"),r.a.createElement(d.a,{dir:"column"},r.a.createElement(p.b,{to:"/hunt/start"},"Start"),b.map((function(e){return r.a.createElement(r.a.Fragment,{key:"nav-".concat(e.slug)},r.a.createElement(f,{puzzle:e}),e.children.map((function(e){return r.a.createElement("span",{key:"nav-".concat(e.slug)},r.a.createElement(f,{puzzle:e,indent:!0}))})),r.a.createElement("hr",null))})))),r.a.createElement("div",{style:{maxWidth:"600px"}},r.a.createElement(h.c,null,r.a.createElement(h.a,{path:"/about"},r.a.createElement("h2",null," About This Hunt "),"How about this hunt, eh?"),r.a.createElement(h.a,{path:"/hunt/:slug"},r.a.createElement(x,{engine:l,version:n})),r.a.createElement(h.a,{path:"/"},r.a.createElement("h2",null,"Welcome to the hunt!"),r.a.createElement("p",null,'This is a proof-of-concept of using react as a hunt engine. You can select "Hunt" in the top navbar (or "start" in the hack bar on the side) to see the start of the hunt. Click "Unlock all" or "Relock unsolve" to auto-unlock/relock all puzzles and rounds.'),r.a.createElement("p",null,"The basic idea was to see if we could make a hunt that lazy-loaded puzzle data aggressively enough that a determined hacker couldn't even deduce the existence of locked puzzles, while still allowing a React-style single-page app. As a bonus, this format would also allow the hunt to be run normally, with unlocks and everything, after the official hunt was over, by reimplementing the unlock logic in javascript and storing the hunt state as a cookie. To that end, this prototype defines an interface in engine/interface.tsx that is the abstract of what a server would need to provide, and then a JS implementation of this in engine/js_engine.tsx so that you can run the hunt right here in your browser."),r.a.createElement("p",null,"I didn't bother actually implementing cookie storage, so right now the hunt state will reset any time you reload the page."),r.a.createElement("p",null,"It's not a real hunt, obviously - none of the puzzles are actually puzzles, and most of them will just accept any answer you provide as the right one."))))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root"))}},[[39,15,16]]]);
//# sourceMappingURL=main.91f78e03.chunk.js.map